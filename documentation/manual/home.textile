h1. Force.com Play! Module

The Force.com Play! module allows you to easily build Play! applications that integrates with Force.com. The module provides Force.com authentication (using OAuth2) and a connector for the REST API.

h2. Prerequisites

To use this module, you'll need to set up a Force.com developer account and create a Force.com Remote Access Application (OAuth Consumer).

* "Read more":force-setup.textile

h2. Usage

Add the module as a dependency in @conf/dependencies.yml@

bc.. require:
    - play
    - play -> force

p. and run @play deps@ on your project. You must provide the oauth key, oauth secret and application base URI as environment variables:

bc.. $ export FORCE_OAUTH_KEY="dHR383djddd3..."
$ export FORCE_OAUTH_SECRET="302832..."
$ export APP_URI="http://localhost:5000/_auth"

p. These are just example values. You must provide your own values. The syntax here is Unix style, use Windows style if you're on Windows.

Now you can write a secured controller like this:

bc.. package controllers;

import com.force.api.Identity;
import controllers.force.ForceController;

public class Application extends ForceController {

    public static void index() {
        Identity identity = api().getIdentity();
        
        render(identity);
    }
    
}

p. with an @index.html@ template like this:

bc.. #{extends 'main.html' /}
#{set title:'Home' /}

<h1>Welcome ${identity.firstName} ${identity.lastName}</h1>

<p>
You are logged in as ${identity.username} in the org with id ${identity.organizationId}
</p>
...

p. The user will be redirected to log in at Force.com and once authenticated, the Play! application can access the Force.com API on behalf of the user.

The module gives access to all the functionality of the Force.com REST API Java library. That library itself is still under development but it has support for basic CRUD and query operations. See the "github project":https://github.com/jesperfj/force-rest-api for details on what you can do with the library.

h2. Sample App

You can find a sample app that demonstrates use of this module "here on github":https://github.com/jesperfj/play-force-sample. To test it out, first clone it

bc.. $ git clone https://github.com/jesperfj/play-force-sample.git

h2. ForceController as Mix-in

You don't have to extend from @ForceController@. You can also apply it as a mix-in with the <code>@With</code> annotation like this:

bc.. package controllers;

import com.force.api.Identity;
import controllers.force.ForceController;

@With(ForceController.class)
public class Application  {
    
    private static void api() {
        return ForceController.api();
    }

    public static void index() {
        Identity identity = api().getIdentity();
        render(identity);
    }
    
}

h2. Reserved Routes

The module will automatically add a new route on @/_auth@. Your application must not route to this path. It is reserved for the OAuth authentication flow.

h2. Advanced Scenarios

This module is designed to get you started quickly with Force.com Play! apps. If you want more control over what happens during the authentication loop, e.g. if you want to load and cache more data when the user is authenticated, then you can simply use the Force.com REST API directly from your Play! application and manually implement the authentication methods currently implemented by ParentController in this module. Feel free to base your code on the code in this module. You can find it "here on github":https://github.com/jesperfj/play-force.
